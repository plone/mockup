(self.webpackChunk_plone_mockup=self.webpackChunk_plone_mockup||[]).push([[65541],{65541:function(e,t,r){
/*
  backbone.paginator
  http://github.com/backbone-paginator/backbone.paginator

  Copyright (c) 2016 Jimmy Yuen Ho Wong and contributors

  @module
  @license MIT
*/
e.exports=function(e,t){"use strict";var r=e.extend,s=e.omit,a=e.clone,i=e.each,n=e.pick,o=e.includes,l=e.isEmpty,c=e.pairs||e.toPairs,u=e.invert,h=e.isArray,f=e.isFunction,g=e.isObject,d=e.keys,P=e.isUndefined,m=Math.ceil,p=Math.floor,v=Math.max,y=t.Collection.prototype;function k(t,r){if(!e.isNumber(t)||e.isNaN(t)||!e.isFinite(t)||~~t!==t)throw new TypeError("`"+r+"` must be a finite integer");return t}function _(e){for(var t,r,s,a,i={},n=decodeURIComponent,o=e.split("&"),l=0,c=o.length;l<c;l++)r=(t=o[l].split("="))[0],null==(s=t[1])&&(s=!0),r=n(r),s=n(s),a=i[r],h(a)?a.push(s):i[r]=a?[a,s]:s;return i}function S(e,t,r){var s=e._events[t];if(s&&s.length){var a=s[s.length-1],i=a.callback;a.callback=function(){try{i.apply(this,arguments),r()}catch(e){throw e}finally{a.callback=i}}}else r()}var R=/[\s'"]/g,b=/[<>\s'"]/g,C=t.PageableCollection=t.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}},constructor:function(e,t){y.constructor.apply(this,arguments),t=t||{};var s=this.mode=t.mode||this.mode||q.mode,i=r({},q.queryParams,this.queryParams,t.queryParams||{});i.directions=r({},q.queryParams.directions,this.queryParams.directions,i.directions),this.queryParams=i;var n=this.state=r({},q.state,this.state,t.state);n.currentPage=null==n.currentPage?n.firstPage:n.currentPage,h(e)||(e=e?[e]:[]),e=e.slice(),"server"==s||null!=n.totalRecords||l(e)||(n.totalRecords=this.length),this.switchMode(s,r({fetch:!1,resetState:!1,models:e},t));var o=t.comparator;if(n.sortKey&&!o&&this.setSorting(n.sortKey,n.order,t),"server"!=s){var c=this.fullCollection;o&&t.full&&(this.comparator=null,c.comparator=o),t.full&&c.sort(),l(e)||this.getPage(n.currentPage)}this._initState=a(this.state)},_makeFullCollection:function(e,r){var s,a,i,n=["url","model","sync","comparator"],o=this.constructor.prototype,l={};for(s=0,a=n.length;s<a;s++)i=n[s],P(o[i])||(l[i]=o[i]);var c=new(t.Collection.extend(l))(e,r);for(s=0,a=n.length;s<a;s++)this[i=n[s]]!==o[i]&&(c[i]=this[i]);return c},_makeCollectionEventHandler:function(e,t){return function(s,n,o,l){var c=e._handlers;i(d(c),(function(r){var s=c[r];e.off(r,s),t.off(r,s)}));var u=a(e.state),h=u.firstPage,f=0===h?u.currentPage:u.currentPage-1,g=u.pageSize,p=f*g,v=p+g;if("add"==s){var y,k,_;if(l=l||{},o==t)(k=t.indexOf(n))>=p&&k<v&&(_=e,y=R=k-p);else{k=p+(y=e.indexOf(n)),_=t;var R=P(l.at)?k:l.at+p}if(l.onRemove||(++u.totalRecords,delete l.onRemove),e.state=e._checkState(u),_){_.add(n,r({},l,{at:R}));var b=y>=g?n:!P(l.at)&&R<v&&e.length>g?e.at(g):null;b&&S(o,s,(function(){e.remove(b,{onAdd:!0})}))}l.silent||e.trigger("pageable:state:change",e.state)}if("remove"==s){if(l.onAdd)delete l.onAdd;else{if(--u.totalRecords){var C=u.totalPages=m(u.totalRecords/g);u.lastPage=0===h?C-1:C||h,u.currentPage>C&&(u.currentPage=u.lastPage)}else u.totalRecords=null,u.totalPages=null;e.state=e._checkState(u);var q,w=l.index;o==e?((q=t.at(v))?S(e,s,(function(){e.push(q,{onRemove:!0})})):!e.length&&u.totalRecords&&e.reset(t.models.slice(p-g,v-g),r({},l,{parse:!1})),t.remove(n)):w>=p&&w<v&&((q=t.at(v-1))&&S(e,s,(function(){e.push(q,{onRemove:!0})})),e.remove(n),!e.length&&u.totalRecords&&e.reset(t.models.slice(p-g,v-g),r({},l,{parse:!1})))}l.silent||e.trigger("pageable:state:change",e.state)}if("reset"==s){if(l=o,(o=n)==e&&null==l.from&&null==l.to){var x=t.models.slice(0,p),z=t.models.slice(p+e.models.length);t.reset(x.concat(e.models).concat(z),l)}else o==t&&((u.totalRecords=t.models.length)||(u.totalRecords=null,u.totalPages=null),"client"==e.mode&&(v=(p=(f=0===(h=u.lastPage=u.currentPage=u.firstPage)?u.currentPage:u.currentPage-1)*g)+g),e.state=e._checkState(u),e.reset(t.models.slice(p,v),r({},l,{parse:!1})));l.silent||e.trigger("pageable:state:change",e.state)}"sort"==s&&(l=o,(o=n)===t&&e.reset(t.models.slice(p,v),r({},l,{parse:!1}))),i(d(c),(function(r){var s=c[r];i([e,t],(function(e){e.on(r,s);var t=e._events[r]||[];t.unshift(t.pop())}))}))}},_checkState:function(e){var t=this.mode,r=this.links,s=e.totalRecords,a=e.pageSize,i=e.currentPage,n=e.firstPage,o=e.totalPages;if(null!=s&&null!=a&&null!=i&&null!=n&&("infinite"!=t||r)){if(s=k(s,"totalRecords"),a=k(a,"pageSize"),i=k(i,"currentPage"),n=k(n,"firstPage"),a<1)throw new RangeError("`pageSize` must be >= 1");if(o=e.totalPages=m(s/a),n<0||n>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===n?v(0,o-1):o||n,"infinite"==t){if(!r[i])throw new RangeError("No link found for page "+i)}else if(i<n||o>0&&(n?i>o:i>=o))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(n?"<":"<=")+" totalPages if "+n+"-based. Got "+i+".")}return e},setPageSize:function(e,t){e=k(e,"pageSize"),t=t||{first:!1};var a=this.state,i=m(a.totalRecords/e),n=i?v(a.firstPage,p(i*a.currentPage/a.totalPages)):a.firstPage;return a=this.state=this._checkState(r({},a,{pageSize:e,currentPage:t.first?a.firstPage:n,totalPages:i})),this.getPage(a.currentPage,s(t,["first"]))},switchMode:function(t,n){if(!o(["server","client","infinite"],t))throw new TypeError('`mode` must be one of "server", "client" or "infinite"');n=n||{fetch:!0,resetState:!0};var l=this.state=n.resetState?a(this._initState):this._checkState(r({},this.state));this.mode=t;var c,u=this,h=this.fullCollection,f=this._handlers=this._handlers||{};if("server"==t||h)"server"==t&&h&&(i(d(f),(function(e){c=f[e],u.off(e,c),h.off(e,c)})),delete this._handlers,this._fullComparator=h.comparator,delete this.fullCollection);else{(h=this._makeFullCollection(n.models||[],n)).pageableCollection=this,this.fullCollection=h;var g=this._makeCollectionEventHandler(this,h);i(["add","remove","reset","sort"],(function(t){f[t]=c=e.bind(g,{},t),u.on(t,c),h.on(t,c)})),h.comparator=this._fullComparator}if("infinite"==t)for(var P=this.links={},p=l.firstPage,y=m(l.totalRecords/l.pageSize),k=0===p?v(0,y-1):y||p,_=l.firstPage;_<=k;_++)P[_]=this.url;else this.links&&delete this.links;return n.silent||this.trigger("pageable:state:change",l),n.fetch?this.fetch(s(n,"fetch","resetState")):this},hasPreviousPage:function(){var e=this.state,t=e.currentPage;return"infinite"!=this.mode?t>e.firstPage:!!this.links[t-1]},hasNextPage:function(){var e=this.state,t=this.state.currentPage;return"infinite"!=this.mode?t<e.lastPage:!!this.links[t+1]},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(e,t){var a=this.mode,i=this.fullCollection;t=t||{fetch:!1};var n=this.state,o=n.firstPage,c=n.currentPage,u=n.lastPage,h=n.pageSize,f=e;switch(e){case"first":f=o;break;case"prev":f=c-1;break;case"next":f=c+1;break;case"last":f=u;break;default:f=k(e,"index")}this.state=this._checkState(r({},n,{currentPage:f})),t.silent||this.trigger("pageable:state:change",this.state),t.from=c,t.to=f;var g=(0===o?f:f-1)*h,d=i&&i.length?i.models.slice(g,g+h):[];return"client"!=a&&("infinite"!=a||l(d))||t.fetch?("infinite"==a&&(t.url=this.links[f]),this.fetch(s(t,"fetch"))):(this.reset(d,s(t,"fetch")),this)},getPageByOffset:function(e,t){if(e<0)throw new RangeError("`offset must be > 0`");e=k(e,"offset");var r=p(e/this.state.pageSize);return 0!==this.state.firstPage&&r++,r>this.state.lastPage&&(r=this.state.lastPage),this.getPage(r,t)},sync:function(e,s,a){var i=this;if("infinite"==i.mode){var n=a.success,o=i.state.currentPage;a.success=function(e,t,s){var l=i.links,c=i.parseLinks(e,r({xhr:s},a));c.first&&(l[i.state.firstPage]=c.first),c.prev&&(l[o-1]=c.prev),c.next&&(l[o+1]=c.next),n&&n(e,t,s)}}return(y.sync||t.sync).call(i,e,s,a)},parseLinks:function(e,t){var r={},s=t.xhr.getResponseHeader("Link");if(s){var a=["first","prev","next"];i(s.split(","),(function(e){var t=e.split(";"),s=t[0].replace(b,""),n=t.slice(1);i(n,(function(e){var t=e.split("="),i=t[0].replace(R,""),n=t[1].replace(R,"");"rel"==i&&o(a,n)&&(r[n]=s)}))}))}return r},parse:function(e,t){var s=this.parseState(e,a(this.queryParams),a(this.state),t);return s&&(this.state=this._checkState(r({},this.state,s)),(t||{}).silent||this.trigger("pageable:state:change",this.state)),this.parseRecords(e,t)},parseState:function(t,r,n,o){if(t&&2===t.length&&g(t[0])&&h(t[1])){var l=a(n),f=t[0];return i(c(s(r,"directions")),(function(t){var r=t[0],s=t[1],a=f[s];P(a)||e.isNull(a)||(l[r]=f[s])})),f.order&&(l.order=1*u(r.directions)[f.order]),l}},parseRecords:function(e,t){return e&&2===e.length&&g(e[0])&&h(e[1])?e[1]:e},fetch:function(t){t=t||{};var a=this._checkState(this.state),o=this.mode;"infinite"!=o||t.url||(t.url=this.links[a.currentPage]);var l=t.data||{},u=t.url||this.url||"";f(u)&&(u=u.call(this));var g=u.indexOf("?");-1!=g&&(r(l,_(u.slice(g+1))),u=u.slice(0,g)),t.url=u,t.data=l;var m="client"==this.mode?n(this.queryParams,"sortKey"):s(n(this.queryParams,d(q.queryParams)),"order","directions","totalPages","totalRecords");i(m,(function(t,r){t=f(t)?t.call(this):t,null!=a[r]&&null!=t&&e.isUndefined(l[t])&&(l[t]=a[r])}),this);var p=f(this.queryParams.sortKey)?this.queryParams.sortKey.call(this):this.queryParams.sortKey,v=f(this.queryParams.order)?this.queryParams.order.call(this):this.queryParams.order;if(null!=p&&null!=a.sortKey&&null!=v&&null!=a.order)if(h(a.order)){l[v]=[];for(var k=0;k<a.order.length;k++)l[v].push(this.queryParams.directions[a.order[k]])}else l[v]=this.queryParams.directions[a.order+""];var S=c(s(this.queryParams,d(q.queryParams)));for(k=0;k<S.length;k++){var R=S[k],b=R[1];null!=(b=f(b)?b.call(this):b)&&(l[R[0]]=b)}if("server"!=o){var C=this,w=this.fullCollection,x=t.success;return t.success=function(e,s,a){a=a||{},P(t.silent)?delete a.silent:a.silent=t.silent;var i=e.models;"client"==o?w.reset(i,a):(w.add(i,r({at:w.length},r(a,{parse:!1}))),C.trigger("reset",C,a)),x&&x(e,s,a)},y.fetch.call(this,r({},t,{silent:!0}))}return y.fetch.call(this,t)},_makeComparator:function(e,t,r){var s=this.state;if(e=e||s.sortKey,t=t||s.order,e&&t)return r||(r=function(e,t){return e.get(t)}),function(s,a){var i,n=r(s,e),o=r(a,e);return 1===t&&(i=n,n=o,o=i),n===o?0:n<o?-1:1}},setSorting:function(e,t,s){var a=this.state;a.sortKey=e,a.order=t=t||a.order;var i=this.fullCollection,n=!1,o=!1;e||(n=o=!0);var l=this.mode;s=r({side:"client"==l?l:"server",full:!0},s);var c=this._makeComparator(e,t,s.sortValue),u=s.full,h=s.side;return"client"==h?u?(i&&(i.comparator=c),n=!0):(this.comparator=c,o=!0):"server"!=h||u||(this.comparator=c),n&&(this.comparator=null),o&&i&&(i.comparator=null),this}}),q=C.prototype;return C}(r(40705),r(95722))}}]);
//# sourceMappingURL=65541.33be0349cf711b1e99ec.min.js.map