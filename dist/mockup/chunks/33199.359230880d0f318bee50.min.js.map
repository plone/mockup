{"version":3,"file":"chunks/33199.359230880d0f318bee50.min.js","mappings":"sMAGe,MAAMA,EACjBC,WAAAA,CAAYC,GACRC,KAAKD,GAAKA,EACVC,KAAKC,qBAAuB,CAAC,uBACjC,CAEAC,IAAAA,GACI,IAAIC,EAAOH,KACXI,IACI,qFAECC,IAAI,SACJC,GAAG,QAAUC,IACV,MAAMC,EAAUJ,IAAEG,EAAEE,eACpB,IAAIC,EAAOF,EAAQG,KAAK,QACxB,GACY,6BAARD,GACQ,0BAARA,EAEA,OAAO,EAEXN,IAAE,YAAYQ,OACd,IAAIC,EAAOL,EAAQM,QAAQ,QAAQC,QAC/BC,EAAWH,EAAKC,QAAQ,YAAYC,QACpCE,EAAOJ,EAAKK,YAAc,IAAMR,EAAO,KACvCS,EAAMN,EAAKF,KAAK,UAOpB,OANAP,IAAAA,KAAOe,EAAKF,EAAOG,IACf,IAAIC,EAAcjB,IAAEgB,GAAME,KAAK,IAAMN,EAASL,KAAK,OACnDK,EAASO,YAAYF,GACrBrB,KAAKE,OACLE,IAAE,YAAYoB,UAEX,IAGfpB,IAAE,8EACGC,IAAI,SACJC,GAAG,QAAUC,IACV,MAAMkB,EAASlB,EAAEE,cAIjB,IAFA,IAAII,EADYT,IAAEqB,GACCC,SAASA,SACxBT,EAAOJ,EAAKK,YACPS,EAAI,EAAGA,EAAIxB,EAAKF,qBAAqB2B,OAAQD,IAClD,IAAoD,IAAhDV,EAAKY,QAAQ1B,EAAKF,qBAAqB0B,IACvC,OAGRpB,EAAEuB,iBACF,IAAIX,EAAMN,EAAKF,KAAK,UAAY,IAAMM,EAClCc,EAAkB3B,IAAE,YAAce,EAAM,QAAQa,IAChD,UACA,QAEJD,EAAgBE,YAAYR,GAC5B,IAAIS,EAAAA,EAAMH,EAAiB,CACvBI,cAAe,CACXC,QAAQ,EACRC,oBAAoB,EACpBC,cAAeA,IAEJC,OAAOC,SAASC,QAInCV,EAAgBW,QAAQ,UAEpC,E","sources":["webpack://@plone/mockup/./src/pat/controlpanels/contentrule-elements--implementation.js"],"sourcesContent":["import $ from \"jquery\";\nimport Modal from \"../modal/modal\";\n\nexport default class Contentrules {\n    constructor(el) {\n        this.el = el;\n        this.SKIP_OVERLAY_ACTIONS = [\"plone.actions.Delete\"];\n    }\n\n    init() {\n        let self = this;\n        $(\n            \"#configure-conditions .rule-element input, #configure-actions .rule-element input\"\n        )\n            .off(\"click\")\n            .on(\"click\", (e) => {\n                const $target = $(e.currentTarget);\n                var name = $target.attr(\"name\");\n                if (\n                    name == \"form.button.EditCondition\" ||\n                    name == \"form.button.EditAction\"\n                ) {\n                    return true;\n                }\n                $(\"#spinner\").show();\n                var form = $target.parents(\"form\").first();\n                var fieldset = form.parents(\"fieldset\").first();\n                var data = form.serialize() + \"&\" + name + \"=1\";\n                var url = form.attr(\"action\");\n                $.post(url, data, (html) => {\n                    var newfieldset = $(html).find(\"#\" + fieldset.attr(\"id\"));\n                    fieldset.replaceWith(newfieldset);\n                    this.init();\n                    $(\"#spinner\").hide();\n                });\n                return false;\n            });\n\n        $('input[name=\"form.button.AddCondition\"],input[name=\"form.button.AddAction\"]')\n            .off(\"click\")\n            .on(\"click\", (e) => {\n                const target = e.currentTarget;\n                const $target = $(target);\n                var form = $target.parent().parent();\n                var data = form.serialize();\n                for (var i = 0; i < self.SKIP_OVERLAY_ACTIONS.length; i++) {\n                    if (data.indexOf(self.SKIP_OVERLAY_ACTIONS[i]) !== -1) {\n                        return;\n                    }\n                }\n                e.preventDefault();\n                var url = form.attr(\"action\") + \"?\" + data;\n                var conditionAnchor = $('<a href=\"' + url + '\" />').css(\n                    \"display\",\n                    \"none\"\n                );\n                conditionAnchor.insertAfter(target);\n                new Modal(conditionAnchor, {\n                    actionOptions: {\n                        isForm: true,\n                        redirectOnResponse: true,\n                        redirectToUrl: () => {\n                            // reload on submit\n                            return window.location.href;\n                        },\n                    },\n                });\n                conditionAnchor.trigger(\"click\");\n            });\n    }\n}\n"],"names":["Contentrules","constructor","el","this","SKIP_OVERLAY_ACTIONS","init","self","$","off","on","e","$target","currentTarget","name","attr","show","form","parents","first","fieldset","data","serialize","url","html","newfieldset","find","replaceWith","hide","target","parent","i","length","indexOf","preventDefault","conditionAnchor","css","insertAfter","Modal","actionOptions","isForm","redirectOnResponse","redirectToUrl","window","location","href","trigger"],"sourceRoot":""}