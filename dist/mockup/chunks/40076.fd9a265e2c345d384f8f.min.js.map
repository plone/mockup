{"version":3,"file":"chunks/40076.fd9a265e2c345d384f8f.min.js","mappings":"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","sources":["webpack://@plone/mockup/./src/pat/controlpanels/contentrules--implementation.js"],"sourcesContent":["import $ from \"jquery\";\n\nexport default class Contentrules {\n    constructor(el) {\n        this.el = el;\n    }\n    updatezebra(table) {\n        table.find(\"tr:visible:odd\").removeClass(\"odd even\").addClass(\"odd\");\n        table.find(\"tr:visible:even\").removeClass(\"odd even\").addClass(\"even\");\n    }\n\n    initStatusMessageArea() {\n        let msgWrapper = document.getElementById(\"portalMessagesWrapper\");\n        if (msgWrapper) {\n            return;\n        }\n        let newNode = document.createElement(\"div\");\n        newNode.id = \"portalMessagesWrapper\";\n        document.getElementById(\"content\").insertAdjacentElement(\"afterbegin\", newNode);\n    }\n\n    addStatusMessage(message, type) {\n        if (type === undefined) {\n            type = \"info\";\n        }\n        let msgDlNode = document.createElement(\"dl\");\n        let msgDtNode = document.createElement(\"dt\");\n        let msgDdNode = document.createElement(\"dd\");\n\n        msgDlNode.classList.add(\"alert\", \"alert-\" + type);\n        msgDtNode.innerText = type;\n        msgDdNode.innerText = message;\n        msgDlNode.appendChild(msgDtNode);\n        msgDlNode.appendChild(msgDdNode);\n\n        let msgWrapper = document.getElementById(\"portalMessagesWrapper\");\n        if (!msgWrapper) {\n            return;\n        }\n        msgWrapper.innerHTML = \"\";\n        msgWrapper.appendChild(msgDlNode);\n    }\n\n    init() {\n        let self = this;\n        self.initStatusMessageArea();\n\n        // TODO find out why is it binding multiple times\n        $(\".btn-rule-action\")\n            .off(\"click\")\n            .on(\"click\", function (e) {\n                e.preventDefault();\n\n                var $this = $(this),\n                    triggerEl = this,\n                    $row = $this.parents(\"tr\").first(),\n                    $table = $row.parent(),\n                    id = $this.data(\"value\"),\n                    url = $this.data(\"url\");\n\n                $.ajax({\n                    type: \"POST\",\n                    url: url,\n                    data: {\n                        \"rule-id\": id,\n                        \"_authenticator\": $('input[name=\"_authenticator\"]').val(),\n                    },\n                    beforeSend: function () {\n                        $(\"#spinner\").show();\n                    },\n                    error: function () {\n                        self.addStatusMessage($(\"#trns_form_error\").html(), \"warn\");\n                    },\n                    success: function () {\n                        let ruleTitle = \"\";\n                        ruleTitle = $row.find(\".rule-title\")[0].innerText;\n\n                        // Enable\n                        if ($this.hasClass(\"btn-rule-enable\")) {\n                            $row.removeClass(\"state-disabled\").addClass(\"state-enabled\");\n                            triggerEl.parentNode\n                                .querySelector(\".btn-rule-enable\")\n                                .classList.add(\"d-none\");\n                            triggerEl.parentNode\n                                .querySelector(\".btn-rule-disable\")\n                                .classList.remove(\"d-none\");\n                            self.addStatusMessage(\n                                $(\"#trns_form_success_enabled\").html() +\n                                    \": \" +\n                                    ruleTitle,\n                                \"info\"\n                            );\n                        }\n\n                        // Disable\n                        if ($this.hasClass(\"btn-rule-disable\")) {\n                            $row.removeClass(\"state-enabled\").addClass(\"state-disabled\");\n                            triggerEl.parentNode\n                                .querySelector(\".btn-rule-disable\")\n                                .classList.add(\"d-none\");\n                            triggerEl.parentNode\n                                .querySelector(\".btn-rule-enable\")\n                                .classList.remove(\"d-none\");\n                            self.addStatusMessage(\n                                $(\"#trns_form_success_disabled\").html() +\n                                    \": \" +\n                                    ruleTitle,\n                                \"info\"\n                            );\n                        }\n\n                        // DELETE\n                        if ($this.hasClass(\"btn-rule-delete\")) {\n                            $row.remove();\n                            self.updatezebra($table);\n                            self.addStatusMessage(\n                                $(\"#trns_form_success_deleted\").html() +\n                                    \": \" +\n                                    ruleTitle,\n                                \"info\"\n                            );\n                        }\n                    },\n                    complete: function () {\n                        $(\"#spinner\").hide();\n                    },\n                });\n            });\n\n        $(\".filter-option input\")\n            .off(\"change\")\n            .on(\"change\", function () {\n                // Go through the checkboxes and map up what is the filtering criterea\n                var $table = $(\"#rules_table_form table\");\n                var state_filters = $(\".state-filters input:checked\");\n                var type_filters = $(\".type-filters input:checked\");\n\n                $table.find(\"tr\").show();\n                if (state_filters.length > 0) {\n                    $(\".state-filters input:not(:checked)\").each(function () {\n                        $table.find(\".\" + this.id).hide();\n                    });\n                }\n                if (type_filters.length > 0) {\n                    $(\".type-filters input:not(:checked)\").each(function () {\n                        $table.find(\".\" + this.id).hide();\n                    });\n                }\n                self.updatezebra($table);\n            });\n\n        $(\"#rules_disable_globally\").on(\"change\", function () {\n            var form = $(\"#fieldset-global form\");\n            var disabled = \"\";\n            if ($(\"#rules_disable_globally\")[0].checked) {\n                disabled = \"True\";\n            }\n\n            $.ajax({\n                type: \"POST\",\n                url: form.attr(\"action\"),\n                data: {\n                    \"global_disable:boolean\": disabled,\n                    \"_authenticator\": $('input[name=\"_authenticator\"]').val(),\n                },\n                beforeSend: function () {\n                    $(\"#spinner\").show();\n                },\n                error: function () {\n                    self.addStatusMessage($(\"#trns_form_error\").html(), \"warn\");\n                },\n                success: function () {\n                    self.addStatusMessage($(\"#trns_form_success\").html(), \"info\");\n                },\n                complete: function () {\n                    $(\"#spinner\").hide();\n                },\n            });\n        });\n    }\n}\n"],"names":["Contentrules","constructor","el","this","updatezebra","table","find","removeClass","addClass","initStatusMessageArea","document","getElementById","newNode","createElement","id","insertAdjacentElement","addStatusMessage","message","type","undefined","msgDlNode","msgDtNode","msgDdNode","classList","add","innerText","appendChild","msgWrapper","innerHTML","init","self","$","off","on","e","preventDefault","$this","triggerEl","$row","parents","first","$table","parent","data","url","val","beforeSend","show","error","html","success","ruleTitle","hasClass","parentNode","querySelector","remove","complete","hide","state_filters","type_filters","length","each","form","disabled","checked","attr"],"sourceRoot":""}